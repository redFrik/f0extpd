//		----------------------------------------------------------//		-- fredrik olofsson 040301								--//		-- converted from abstraction with the same name		--//		-- ported to pd 060511									--//		-- distributed under GNU GPL license					--//		----------------------------------------------------------#include "m_pd.h"static t_class *f0ext_class;typedef struct _f0ext {	t_object ob;	t_float valLeft;	t_float valRight;	t_float proportionLeft;	t_float proportionRight;	t_outlet *out;	t_outlet *out2;} t_f0ext;void *f0ext_new(t_symbol *s, int argc, t_atom *argv) {	t_f0ext *x= (t_f0ext *)pd_new(f0ext_class);	inlet_new(&x->ob, &x->ob.ob_pd, gensym("float"), gensym("ft1"));	x->valLeft= 0.0;	x->proportionLeft= 1.0;	x->proportionRight= 1.0;	switch(argc) {		case 2:			x->proportionRight= atom_getfloat(argv+1);			if(x->proportionRight==0.0) {				x->proportionRight= 1.0;			}		case 1:			x->proportionLeft= atom_getfloat(argv);			if(x->proportionLeft==0.0) {				x->proportionLeft= 1.0;			}	}	x->out= outlet_new(&x->ob, gensym("float"));	x->out2= outlet_new(&x->ob, gensym("float"));	return (void *)x;}void f0ext_bang(t_f0ext *x) {	outlet_float(x->out2, x->valRight);	outlet_float(x->out, x->valLeft);}void f0ext_float(t_f0ext *x, t_floatarg val) {	x->valLeft= val;	x->valRight= (val/x->proportionLeft)*x->proportionRight;	f0ext_bang(x);}void f0ext_ft1(t_f0ext *x, t_floatarg val) {	x->valLeft= (val/x->proportionRight)*x->proportionLeft;	x->valRight= val;	f0ext_bang(x);}void f0ext_set(t_f0ext *x, t_floatarg val1, t_floatarg val2) {	if(val1==0.0) {		x->proportionLeft= 1.0;	} else {		x->proportionLeft= val1;	}	if(val2==0.0) {		x->proportionRight= 1.0;	} else {		x->proportionRight= val2;	}}void f0_ratio_setup(void) {	f0ext_class= class_new(gensym("f0_ratio"), (t_newmethod)f0ext_new, 0, sizeof(t_f0ext), 0, A_GIMME, 0);	class_addbang(f0ext_class, (t_method)f0ext_bang);	class_addfloat(f0ext_class, f0ext_float);	class_addmethod(f0ext_class, (t_method)f0ext_ft1, gensym("ft1"), A_DEFFLOAT, 0);	class_addmethod(f0ext_class, (t_method)f0ext_set, gensym("set"), A_DEFFLOAT, A_DEFFLOAT, 0);	post("f0_ratio v2.0; distributed under GNU GPL license");}